{"componentChunkName":"component---src-templates-blog-post-js","path":"/nextjs/next-isr/","result":{"data":{"site":{"siteMetadata":{"title":"Youthfulhps.dev","description":"Blog posted front-end, troubleshooting!","author":"youthfulhps","siteUrl":"https://youthfulhps.dev","comment":{"disqusShortName":"youthfulhps","utterances":"youthfulhps/youthfulhps.github.io"},"sponsor":{"buyMeACoffeeId":"youthfulhps"}}},"markdownRemark":{"id":"39021f2a-3bfa-5388-a29f-8e7145b9490d","excerpt":"최근 CRA 프로젝트를 넥스트로 이관하는 작업이 한창입니다. 넥스트는 서버 사이드 랜더링과 동시에 클라이언트 사이드 랜더링을\n동시에 지원하기 때문에 점진적 이관이 가능했죠. 단순히 빌드가 실패되는 문제들을 제외하면요. 이후 적절한 , ,  를 통해 서버 사이드에서 데이터 패칭이\n이루어질 수 있도록 작업했습니다. 작업할 때 서버 사이드 랜더링()보다는 정적 사이트 생성() 방식으로\n접근하려 했습니다. SSR vs SSG…","html":"<p>최근 CRA 프로젝트를 넥스트로 이관하는 작업이 한창입니다. 넥스트는 서버 사이드 랜더링과 동시에 클라이언트 사이드 랜더링을\n동시에 지원하기 때문에 점진적 이관이 가능했죠. 단순히 빌드가 실패되는 문제들을 제외하면요.</p>\n<p>이후 적절한 <code class=\"language-text\">getStaticProps</code>, <code class=\"language-text\">getStaticPaths</code>, <code class=\"language-text\">getServerSideProps</code> 를 통해 서버 사이드에서 데이터 패칭이\n이루어질 수 있도록 작업했습니다.</p>\n<p>작업할 때 서버 사이드 랜더링(<code class=\"language-text\">Server Side Rendering</code>)보다는 정적 사이트 생성(<code class=\"language-text\">Static Site Generation</code>) 방식으로\n접근하려 했습니다.</p>\n<h2 id=\"ssr-vs-ssg\" style=\"position:relative;\"><a href=\"#ssr-vs-ssg\" aria-label=\"ssr vs ssg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSR vs SSG</h2>\n<p>넥스트는 서버 사이드에서 데이터 패칭을 할 수 있도록 두 가지 함수를 제공합니다.\n두 함수의 가장 큰 차이점은 단연 데이터 패칭의 시점인데요.</p>\n<p><strong><code class=\"language-text\">getServerSideProps</code>의 경우</strong>, 클라이언트에서 요청이 들어올 때\n데이터 패칭을 통해 외부 데이터를 json파일에 담고, 마크업을 생성하여 클라이언트로 전달합니다.</p>\n<p>반대로 <strong><code class=\"language-text\">getStaticProps</code>의 경우</strong>, 빌드 시 한번만 모든 페이지의 마크업과 데이터 패칭을 통해\n얻은 외부 데이터를 json파일에 담아두고, 요청 때 캐싱되어 있는 마크업, json 파일을 클라이언트로 전달합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQoz41S6cqCUBD1/Z/DF/GfIIhoblAklRu5YJnaOn1nYC721bcMnGZus9xzrqPRlz0eD/qP3e/3lxiQXvGaBKvVimzbJtd1yfd9RhiGdD6fudHzPM4vl0taLBbkOA4FQUBxHDNeBgLDMNA0TTzgcrmwH8eRJI/z9Xpl3G43xRBn5ISl9pfcT3m5YJ5TDPGTJAnTX6/XVJYl1XXNHkxgYNE0DVVVRWmass+yjOuOxyOrUwwRRFFEuq7z20BG3/f8phgEA5vtdquad7sdD8zznDabDe33+3fJp9OJgTPeUth9MgyGAtS9SZbgcDjwTUVR8M2IIVPkyMq0bcsKMBQ9kD9fHW0+HU2QgIECNM5rsC6mafJ6WZZFhmEopkryHF3XMbP5EksOhg8BgBnqoEhqFcPvTT/999uKSe4JX0VSsavrbWQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"comparison\"\n        title=\"comparison\"\n        src=\"/static/cd29985dffb91fc65d52899ac3d1fb4c/c1b63/comparison.png\"\n        srcset=\"/static/cd29985dffb91fc65d52899ac3d1fb4c/5a46d/comparison.png 300w,\n/static/cd29985dffb91fc65d52899ac3d1fb4c/0a47e/comparison.png 600w,\n/static/cd29985dffb91fc65d52899ac3d1fb4c/c1b63/comparison.png 1200w,\n/static/cd29985dffb91fc65d52899ac3d1fb4c/73a2e/comparison.png 1439w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h2 id=\"정적-생성을-지향했던-이유\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EC%A0%81-%EC%83%9D%EC%84%B1%EC%9D%84-%EC%A7%80%ED%96%A5%ED%96%88%EB%8D%98-%EC%9D%B4%EC%9C%A0\" aria-label=\"정적 생성을 지향했던 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정적 생성을 지향했던 이유</h2>\n<p>정적 생성된 페이지는 클라이언트의 요청 시 상당히 빠르게 제공됩니다.\n빌드 시 생성한 마크업과 데이터가 담긴 json을 제공하기 때문인데요.</p>\n<p>이는 <code class=\"language-text\">Time to First Byte (TTFB)</code>를 크게 줄일 수 있을 뿐만 아니라, <code class=\"language-text\">First Input Delay (FID)</code>와 같은 Web Vital Score를 개선하는 데 큰 도움이 됩니다.</p>\n<p>좋지 못한 네트워크 상에서 비교 측정해봤을 때 초 단위로 측정되는 <code class=\"language-text\">SSR</code>에 반해 <code class=\"language-text\">SSG</code>는 밀리 초 단위로\n측정되는 것을 확인할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 725px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfUlEQVQI143PQQ6CMABEUa4BBpQihQLaFqWAJnVrNJp4/8N8yw26eLufSSYZThY7TvSDphQ1RVGRp4I8i5SW7Isjg7nQ9ppkvXte7y9Xt7DLDrRzh/0Z9EdHMaFtrORhJ57ek5z1yC2MbqTsEKqmXToap6JsbaUkc3joJ8cfZudbtKRgxOIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ttfb-ssr\"\n        title=\"ttfb-ssr\"\n        src=\"/static/b48a30b5a039e12be6c87bd8e1198e25/a0209/ttfb-ssr.png\"\n        srcset=\"/static/b48a30b5a039e12be6c87bd8e1198e25/5a46d/ttfb-ssr.png 300w,\n/static/b48a30b5a039e12be6c87bd8e1198e25/0a47e/ttfb-ssr.png 600w,\n/static/b48a30b5a039e12be6c87bd8e1198e25/a0209/ttfb-ssr.png 725w\"\n        sizes=\"(max-width: 725px) 100vw, 725px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 725px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgElEQVQI15XNSw6CMAAAUc4hUQpUaBHbEiEG5Rc3QiAuvP9dxp7A6OJtZwJXNRh3QR4VkUg5hAn73R/CmDTTnKuaRCqCednoxwdCSEQqMYvFbt76nVkN7uXIb5q6KHk/Z5rSENy7kW6YcP4QxQnqqlFt8RPd5mTDgDtZ5q6n8uEPSkpb6WVDb5cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ttfb-ssg\"\n        title=\"ttfb-ssg\"\n        src=\"/static/7fc71abf4225f99ff2b462510ff84e9b/a0209/ttfb-ssg.png\"\n        srcset=\"/static/7fc71abf4225f99ff2b462510ff84e9b/5a46d/ttfb-ssg.png 300w,\n/static/7fc71abf4225f99ff2b462510ff84e9b/0a47e/ttfb-ssg.png 600w,\n/static/7fc71abf4225f99ff2b462510ff84e9b/a0209/ttfb-ssg.png 725w\"\n        sizes=\"(max-width: 725px) 100vw, 725px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>추가적으로 클라이언트의 요청 횟수에 상관없이 서버측은 빌드 시 제공된 한번의 응답이면 충분하게 됩니다.</p>\n<h2 id=\"증분-정적-재생성\" style=\"position:relative;\"><a href=\"#%EC%A6%9D%EB%B6%84-%EC%A0%95%EC%A0%81-%EC%9E%AC%EC%83%9D%EC%84%B1\" aria-label=\"증분 정적 재생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>증분 정적 재생성</h2>\n<p>그러나 한 가지 염두해야 할 것이 있다면, 제공하는 서비스 특성상 데이터가 실시간으로 업데이트되어야 한다면\n<strong>빌드되는 시점에 받은 외부 데이터가 최신화된 데이터로서 유효하지 않다는 점</strong>입니다.</p>\n<p>그래도 넥스트가 정적 생성을 권장하는 근거가 있다면, <a href=\"https://vercel.com/docs/concepts/next.js/incremental-static-regeneration\">증분 정적 재생성</a>\n(Incremental Static Regeneration)라 생각이 듭니다.</p>\n<p>위 문서를 읽어보면 증분 정적 재생성을 하기 위해서는 <code class=\"language-text\">getStaticProps</code>의 반환 프로퍼티로 <code class=\"language-text\">revalidate</code> 값을\n설정하면, 설정된 초 단위 마다 넥스트에서 데이터 유효성 검사를 진행할거다 정도로 쉽게 받아드릴 수 있습니다.</p>\n<p>하지만, <code class=\"language-text\">revalidate</code> 가 되는 시점과 트리거에 대한 이해가 필연적입니다.</p>\n<h2 id=\"증분-정적-재생성의-타임라인\" style=\"position:relative;\"><a href=\"#%EC%A6%9D%EB%B6%84-%EC%A0%95%EC%A0%81-%EC%9E%AC%EC%83%9D%EC%84%B1%EC%9D%98-%ED%83%80%EC%9E%84%EB%9D%BC%EC%9D%B8\" aria-label=\"증분 정적 재생성의 타임라인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>증분 정적 재생성의 타임라인</h2>\n<p>증분 정적 재생성(<code class=\"language-text\">ISR</code>)은 <code class=\"language-text\">SSG</code> 과 동일한 넥스트 API(<code class=\"language-text\">getStaticProps</code>)로 정적 페이지를 생성합니다. <code class=\"language-text\">revalidate</code> 값을 설정하여\n생성된 페이지를 업데이트하도록 알리는데요.</p>\n<p>단순하게 <code class=\"language-text\">revalidate</code>값이 20초라면, 특정 페이지에 대한 첫 요청이\n들어온 이후 20초마다 한번 씩 유효성 검사를 한다는 것으로 오해할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQoz61TYUvDMBDN//8XokJVVBy4KTKdOK1MsOyLX4TpNtiMraut2G1tLs80JVtaql/c0Qf37iWvl0vLsOFgJpFSath5FVWtuq9kaBv/FlWtbm1hqOqkRJIEUuQzjsDfOdIshVC1WTjDh0Ku5zU/8BGpNaq3Yo+CMWe1b04EltF8xZfxQsNEEn6Dkqz2BMyYPSdDuL6HXtDH9fgely+3cPmjxtXrnYbh7UEXnaGrcg830wf0+RMkUbnDbuLhML7AcdiGMznFzugEB8E59v0z7I4amu/xFpy3JrYGR5o70ya2Jw20xh1QJtaGQgjQXKx7T9XztSiNQFp6mh/fPrGSyHS4un5rwKSZNfA8/4PnFwpZeLC6b+k/nG36T/kBXvdWIswmZzoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"wrong\"\n        title=\"wrong\"\n        src=\"/static/2216cba94a9164a33086e2c74a9323f9/c1b63/wrong.png\"\n        srcset=\"/static/2216cba94a9164a33086e2c74a9323f9/5a46d/wrong.png 300w,\n/static/2216cba94a9164a33086e2c74a9323f9/0a47e/wrong.png 600w,\n/static/2216cba94a9164a33086e2c74a9323f9/c1b63/wrong.png 1200w,\n/static/2216cba94a9164a33086e2c74a9323f9/1bba3/wrong.png 1433w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>정확한 플로우는 공식 문서에서 다음과 같이 설명하고 있습니다. 이제, 이 플로우를 하나 씩 살펴 봅시다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVQoz52S6a6CQAyFef/H0wQCgixqEBdQtgSC1nxNShDvrztJ0216eqZT5/V6SV3X8nw+Z8F/PB4q2GVZqk0O3batvN9v4aDN5jjDMMhut5MoiiQMQ7XRQRCI7/uSZZlst1txXVf2+/0cg8ifgGY0TSNVVSkDGMHsdrvNTImRJ36/31UvAQ1UAelGQVEUKufzWa7X6+zneS6Xy2UWfPJrhmjHDObDJbqbWBM0IMYKAsia3RcgBWmaShzHcjqdJEkSnSsxfEAZAc/GNh8iS6Yz4PF41GKEoZsQB9BY2ytsnsx3HMdvhtCnEAEElofDQX8Vnyb8OnFibAF5Y9r3/S8gl1gNz/Nks9koAEU8G1BGYOBmo/Fh+zNDW2J7Rtd12miaJs3bR6xlveDOcin/e5Y//QG6pkhkD6LgGgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-flow\"\n        title=\"isr-flow\"\n        src=\"/static/bf23846d96f83f4ba7e4723f33816ad8/c1b63/isr-flow.png\"\n        srcset=\"/static/bf23846d96f83f4ba7e4723f33816ad8/5a46d/isr-flow.png 300w,\n/static/bf23846d96f83f4ba7e4723f33816ad8/0a47e/isr-flow.png 600w,\n/static/bf23846d96f83f4ba7e4723f33816ad8/c1b63/isr-flow.png 1200w,\n/static/bf23846d96f83f4ba7e4723f33816ad8/85e74/isr-flow.png 1436w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><code class=\"language-text\">revalidate</code> 는 20초, 빌드 시 페이지 정적 생성이 이루어졌다면,\n초기 페이지를 요청(1)한다면, 0s 기준으로 캐싱되어 있는 페이지를 응답받습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQoz61T0UrDMBTN///CoCCbTFxBnSDCnnxydG7dxlD6MEWnFi2lqYFO2yTH9LquUfYyt0sOzWnI4Z57WoY9F9Na4y/Kqp5bC256+V8xEsyyDJxzJDwBTzlyWUBBQ2m1FaommFIKQgh8xCmM0k5VipLlUvQuncPntxjGM3hvY/RDH4NoSuiHI8IgmsAzuH4drrg5e/cxiwIoqaxQzOYqu0E7vsBxdImDxxM48w4Ow3OCc+8Sb7100Xw+RSM4It5cnMF5ctF96EHmRR1KUZi5LWXde26W+KqtmDO9rOeRi09zyfIqf1yuO6RLdhDEfnM7KL0hNKycsmqY9qeyC2f7/lO+AWLcVuG9XqJ4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-step-1\"\n        title=\"isr-step-1\"\n        src=\"/static/b10448a487895f3798cd16f6763ef007/c1b63/step-1.png\"\n        srcset=\"/static/b10448a487895f3798cd16f6763ef007/5a46d/step-1.png 300w,\n/static/b10448a487895f3798cd16f6763ef007/0a47e/step-1.png 600w,\n/static/b10448a487895f3798cd16f6763ef007/c1b63/step-1.png 1200w,\n/static/b10448a487895f3798cd16f6763ef007/e515d/step-1.png 1430w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>만약, 20초 이내에 새로운 요청(2)을 보냈다면, 이것 또한 기존 캐싱되어 있는 페이지를 응답받습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz62TW0sCQRTH5/t/ix4WopuUhCFEatpNIwifohfvqyvjarRbOWf+zjkg4y69bHngMOc3s/znXGYV9mzKWou8s23XwoL5jf8KqyRJoLWGXmjEyxiGDJwcyFIh314sJbNoNJ5hOY0xH82QLj4BU7xc1pKSiQjd+A2t6Bk3/TvcjttoDB/RCjtoOq+7mL0p3EZt8CDM543JE17CLsiQz5Dt/usVpdU1yqsaDkeXCHrnOJ1XcRJVEfQvhI+nVzgKKzh4PxPmOJiUURnUYdbGD8UYA0rXPncX/nx8e05dj1LfAznb+Zzbw1VmMswMQsiz/YUpMzjLArKvdp9K/un8hdW+/5QNu7FWVJPUnrEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-step-2\"\n        title=\"isr-step-2\"\n        src=\"/static/e924db212802ad75c4e7f965fb35ea20/c1b63/step-2.png\"\n        srcset=\"/static/e924db212802ad75c4e7f965fb35ea20/5a46d/step-2.png 300w,\n/static/e924db212802ad75c4e7f965fb35ea20/0a47e/step-2.png 600w,\n/static/e924db212802ad75c4e7f965fb35ea20/c1b63/step-2.png 1200w,\n/static/e924db212802ad75c4e7f965fb35ea20/1bba3/step-2.png 1433w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>드디어 20초가 지나서 새로운 요청(3)을 보냈습니다. 넥스트에서는 설정해둔 20초가 지났기 때문에\n캐싱된 페이지에 대해 유효성 검사를 진행하고, 새롭게 캐싱된 페이지가 전달될 거라 기대하지만, 그렇지 않습니다.\n<strong>마찬가지로, 캐싱된 페이지를 응답받습니다.</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJUlEQVQoz61TXU+DMBTl//8LE6eJn3EzcRpNhjLdzHQPxgcfNCq4AVsYjhXG2ttj6SRgYhyJazjhnrT30HNKDax5GFJKrEI28vdKwSqLqoppQcYYgiBAMAkQTkPM0zkiNgOLGaJZhIXgUPsESfoT+Ue15TiOMfrwEXoTDF8HGDs+fNsFn6WAqJ5fpqUtCxJ4CJ9geT20nA6uvTucv1zhxr9HW9Wm09Ww3J6GaXc0b6v6cniLvvcIEvSdoVwqW0kfh9ML1D9b2HaOsfXewP74DHujU9Te6gpH2PWa2HFPsPF8gE3Fs7o2aKBpmxBcFIfCOQclJW8L9URpYSUWkAkV09kcL3lVrURUZKibysFrVnD5C6cfB5XZXGoYeZjlX+M/3Fj3TfkCbqdVS0Qj/5IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-step-3\"\n        title=\"isr-step-3\"\n        src=\"/static/eebdbd40e5a2b218404d6e20b6767d8a/c1b63/step-3.png\"\n        srcset=\"/static/eebdbd40e5a2b218404d6e20b6767d8a/5a46d/step-3.png 300w,\n/static/eebdbd40e5a2b218404d6e20b6767d8a/0a47e/step-3.png 600w,\n/static/eebdbd40e5a2b218404d6e20b6767d8a/c1b63/step-3.png 1200w,\n/static/eebdbd40e5a2b218404d6e20b6767d8a/b6c94/step-3.png 1429w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이 단계에서 예상과는 다르게 새롭게 재생성된 페이지를 전달받지 못한 것에 대해 약간의 혼란이 생깁니다.\n그렇다면, 넥스트는 어느 시점에서 새롭게 유효성을 검사할까요?</p>\n<p>바로, <strong>20초가 지나서 전달된 새로운 요청(3)이 유효성 재검사의 트리거가 됩니다.</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQoz41S20rDQBDN/7+KSC0IiootIr755gf4oBSK4KUxm9A0SbO535rbcWdqi0YfHDjJ7O7s2TMXra5rFEWBqqqw2WwwtL7v/w0yjYjCMITruvB9H0EQwHEceJ7H+03T4L9GpBo5bdsygfQl9IUOz/UgDIEiy1EW5R5VWTGG63pTQ2ncKtxJvc8fcLK+wal7i7E5xdHiEmNrimNrgsO3c8bInGAkrnDwcsbrY7U+FBe41u/QNu2WkD5d28Ep1nAaH27t4yOy8OK+K18yFlLgba1jVa0Zz/YrPkITdunBzGws4xVz7AlZZdv/qEcsI5SpalauUiq2zUqCGK7toK1UXSm8+bqjfl3X/UyZlSq/67cHMpBI0gRBGHCjqEFCCBjCwOPTI2azGTdyF78zbTgaZDRKUkpkWcagrhOpYRiYz+eIomh/Rj5NR5qm3Fxt2HZWquRTQBzHfIFGi2y5XMKyLCaiPQI9TLF5nvM97a9Z2hkppXEigiRJmMy2bYZpmrxHqn6lPCT7nv6+vup1UkupD0m+l+wTXAVLDpDcvfIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-step-4\"\n        title=\"isr-step-4\"\n        src=\"/static/f1b70e24e4931788a802afc692f1cf8f/c1b63/step-4.png\"\n        srcset=\"/static/f1b70e24e4931788a802afc692f1cf8f/5a46d/step-4.png 300w,\n/static/f1b70e24e4931788a802afc692f1cf8f/0a47e/step-4.png 600w,\n/static/f1b70e24e4931788a802afc692f1cf8f/c1b63/step-4.png 1200w,\n/static/f1b70e24e4931788a802afc692f1cf8f/4c5bd/step-4.png 1435w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>넥스트는 20초가 지난 시점에서 새로운 요청(3)이 들어오면 기존의 캐싱되어 있던 페이지의 유효성을 재검사합니다.\n<strong>이때 재생성이 성공한다면, 기존의 캐싱된 페이지는 무효화되며, 재생성된 페이지가 새롭게 캐싱됩니다.</strong>\n만약, 모종의 이유로 재생성에 실패한다면, 기존의 캐싱된 페이지가 유효하게 유지됩니다.</p>\n<p>이 시점을 왜 재생성의 트리거로 설정했을 까라는 생각을 오래했는데, 20초 마다 조건없이 재생성하기 보다는,\n20초 이후 새로운 요청이 들어와 업데이트된 정보를 필요로 하는 클라이언트의 수요를 확인하고\n재생성이 이루어지는 것이 훨씬 경제적일 거라는 판단이지 않을까라는 개인적인 생각을 했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOUlEQVQoz61Sy07CQBTt/3+FCZogCYloQl1ofAZQI+hCNxojUqAdkLb0zTyOM6OF1oV04U1Obk57cua+DPxzGEIIbIOKPG81rCKqaqYN4ziG67pYSHhLH2mWIoxCRHGEQOYVo5B1ggv+J/JHdcvKlIwd+I6L6fsEc4uAfNigQQaw6vNTXrplzjmevBd0SR8Xoxv0nAFO367RIwN0nT6urFuNjn2vcSk1indt+W96h0fnGUJ6rCtU0Ukf0FyeoOWfYc86wu6whcbsGA1iojY80Nh3TNTtNnZem5rXp23UJocwR+fglG2WwhgDT2ip/HgRAtkPSeSMkk3vqyAFinL23WWpwnzwTGL2OYc1tjTIjCBbZVCq9QKUtrQooQz0dyMfZvHefN/Xm1fZ8zxQSkvnU9T/5kbVe6t6i19Gw1N61dj6iwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"isr-step-5\"\n        title=\"isr-step-5\"\n        src=\"/static/fcce8f8d1e4728edca4cf3b3ecef0d4b/c1b63/step-5.png\"\n        srcset=\"/static/fcce8f8d1e4728edca4cf3b3ecef0d4b/5a46d/step-5.png 300w,\n/static/fcce8f8d1e4728edca4cf3b3ecef0d4b/0a47e/step-5.png 600w,\n/static/fcce8f8d1e4728edca4cf3b3ecef0d4b/c1b63/step-5.png 1200w,\n/static/fcce8f8d1e4728edca4cf3b3ecef0d4b/1bba3/step-5.png 1433w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>재생성이 완료된 이후 시점에서 새로운 요청(4)이 들어온다면, 재생성이 성공했다는 가정하에 재생성된 페이지를 응답 받게 됩니다.</p>\n<h2 id=\"isr를-적용하기-앞서\" style=\"position:relative;\"><a href=\"#isr%EB%A5%BC-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0-%EC%95%9E%EC%84%9C\" aria-label=\"isr를 적용하기 앞서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ISR를 적용하기 앞서</h2>\n<p>사실, 실시간으로 업데이트되어야 하는 제품 상세 페이지에 ISR을 적용하기란 생각보다 불안했습니다.\n그래서 ISR을 타임라인을 그려보기도 하고, 생각보다 비슷한 걱정을 한 이야기들을 보기 위해 괜히\n<a href=\"https://github.com/vercel/next.js/discussions?discussions_q=ecommerce\">디스커션</a>\n을 읽어보기도 했습니다.</p>\n<p>맘 편하게 <code class=\"language-text\">TTFB</code> 를 조금 양보하더라도 서버 사이드에서 데이터 패칭하도록 할까 라는 생각도 했었지만,\nSSG의 응답 속도를 한번이라도 경험해보신 분들은 절대 포기못 할 속도일 겁니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 709px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADZElEQVQozz2Sa0+TBxiG318yUShCaStnJqcgFDQgLadSKAqUDmQIWlB0IEbBIWwCahnGMYGoRE3cihSDRIdDOoRY5RBhynSEEZmTcuiB7mCWXXu3D/tw5/525XpyP4K5OoP82HC00eFU7Y2nLkuJPjGK3LidjJiMuBasLA91smQxYZ/7jod9t+k420V/ezs/DnzJi2Ez+sIq8nWlFGTqEfpqNKTHRXD9RCHHMhPIjg4jOSKUhiIVbx9dZWN+DPvQZWZaP2bh689ZX5xl7Z2H4bs2fr5/hz9/GOHMyWaSlRp0aXkIT5pzmbpQwtWKVFIjQ0gIDyZcJuWzKj3WS8exntYyWJPFeMcnmPJSGfvGwt/v3zM98yvTI0/56/Ukz59NYSg8Sk56PsL9OjW16ijCg0JQxsQQGxaKzEdCozGfxf42XpvKeNJUxHR7Jd21dZi/6mfh6Uuso4vYxhZw/7LCb+urPBgaR6MuREiJDMRX4kewTEGoXMGHCgVhAVIay7JYuF7PeGMJ8xfLeXuzBdvgY0YtNuYev2LGtsxPs+/YWHHidjh58XyR6kMNCF5eEqR+MjFSFP4BIlQuGvpxslSH9byR9jwlo+cO8+bbu6y8WsO57MS15sa17mbTKbYIW7O7MfdNcUEcS5BL5SIsgAB/Gf6+UoICFEi2Sqgo0DB3q41uw156jRpmb1/jd7sHpwhwbjj/73+BLocH6/eLnG/uQQhSBBIREsoOmRyfbT74ekvw9tpGVGgwV2qL6TJq6a5M506DkaXZN7hcmyLIgXPN9R9w07HJ/NwKA5YpTOe6EbZ8sBX/7RJ2iKfuit2JNk1FScF+DHoDhn156HbHUJymJDNpD60tN1m1/4Fz3YFDjNvhYumlnQHzNG0tN6jQlSHERUaSkhhPbqaaE5XldLY28ezhIPdu9XKgqJg9KVoSElKJj01Ck2Gg68ogqysePG4Prg3Rdt3Do+FJPj1ST1laDoIqKZFdkdEEyQPFx1RTUZjPxFA/TcdryVblUFp6jAMlleRm5JAcv5uzp5oYHZpg5N4kDywT9PVa6O+5gfniJWpVWeLKW7zxEVf13y5Dm5LCfrWKmoNl1Bw+ir6gnCPVZ/iiQ7T9qBS1Mgm9Rse+jCKM5afpvWyh/tApTOUHsfV00qLJ5h/7U27IJe1LfwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fast\"\n        title=\"fast\"\n        src=\"/static/33d2719e99724dfa5a914b88059481ef/4d08a/fast1.png\"\n        srcset=\"/static/33d2719e99724dfa5a914b88059481ef/5a46d/fast1.png 300w,\n/static/33d2719e99724dfa5a914b88059481ef/0a47e/fast1.png 600w,\n/static/33d2719e99724dfa5a914b88059481ef/4d08a/fast1.png 709w\"\n        sizes=\"(max-width: 709px) 100vw, 709px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>나름의 합의점을 찾자면, ISR을 통해 속도 최적화를 챙기면서\n가격 변동이나 남은 수량과 같은 실시간 정보를 필요로 하는 곳은 랜더링 직후 클라이언트에서 데이터 패칭을 통해\nUI에 영향이 가지 않는 선에서 스토어를 업데이트해주는 방향을 선택할 수 있습니다.</p>\n<p>ISR과 함께 데이터 재검증에 대한 고민을 하다보니 <a href=\"https://swr.vercel.app/ko\">SWR</a>가 자주 등장하는데요.\nISR를 적용하고 나서 풀어야 할 숙제가 남아 있기 때문에 SWR를 추가적으로 공부해보려 합니다.</p>\n<p><code class=\"language-text\">SWR</code> 을 <code class=\"language-text\">ISR</code> 와 함께 사용한 예제들을 보면 정적 랜더링 이후 포커싱이 돌아오거나, 네트워크가 회복되었을 때 데이터 패칭을 통해 업데이트된 외부 데이터를 UI에\n적용시켜줍니다. 어쩌면 스토어 따윈 필요로 하지 않는 클라이언트 개발이 얼마 남지 않은 것 같네요.b</p>\n<h2 id=\"마치면서\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B4%EC%84%9C\" aria-label=\"마치면서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마치면서</h2>\n<p>최근 넥스트로 이관하면서 최적화에 재미가 붙은 것 같습니다. 작업할 때 Web Vital Score을 신경쓰게 되었고,\n페이지별로 감점 요소를 찾고 추가 작업을 합니다. 이번 작업을 진행하면서 고민할 것들도 늘었구요.</p>\n<p>그러다 오른 점수를 보면 마냥 행복해지는 게 숙명이 아닌 가 싶습니다. 얼른 90점을 넘겨 초록색 게이지를 보고 싶네요!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1016px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVQoz21Q0WrDMAyMZMeJEzuJMzo2NhgbbBT2UBi0L9sf7P+/5ybJaSmjgUOycnc6u1nXFTFGpJQwDANyzpjn2fplWWyuUF4pxapB+nIDzTRNUBQRL8tsZmqqJmqo55QyxlwXXpCmumwcjW+QcyOfCXe7HdK8mlhnIQSMQp7UfBzgo7f5GRTvEPqE0HXI04JpLhhGMXSOjeCYsH908FwFfd/DOSeEDtQOIB9BYdyQwF2qc0HjpYYMbqNqCfeZcPx8xunwjp8PG8q7bobkwF5MXYuGJSXXys6DNOmWWAN55athGRr8Hh/wfXjB6a2vhpLQ+ypiIRNV8bkys/R0gS5XfuO4XvlpDfh6jTXVdmXe/pn4nwHfOJshEdtW13b2Xja8fkNLRRfz696uunHO+AN/ea6NbgcEfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"web-vital-score\"\n        title=\"web-vital-score\"\n        src=\"/static/23eff5fbf5f5c901814a7b14b9a3daa1/f4281/web-vital-score.png\"\n        srcset=\"/static/23eff5fbf5f5c901814a7b14b9a3daa1/5a46d/web-vital-score.png 300w,\n/static/23eff5fbf5f5c901814a7b14b9a3daa1/0a47e/web-vital-score.png 600w,\n/static/23eff5fbf5f5c901814a7b14b9a3daa1/f4281/web-vital-score.png 1016w\"\n        sizes=\"(max-width: 1016px) 100vw, 1016px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>","frontmatter":{"title":"Incremental Static Regeneration 타임라인 이해하기","description":"증분 정적 생성의 타임라인을 살펴봅니다.","date":"January 08, 2022"}}},"pageContext":{"slug":"/nextjs/next-isr/","previous":{"fields":{"slug":"/nextjs/cra-to-next/"},"frontmatter":{"title":"CRA 프로젝트를 next.js로 전환해보자"}},"next":{"fields":{"slug":"/javascript/javascript-prototype/"},"frontmatter":{"title":"자바스크립트 프로토타입 톺아보기"}}}},"staticQueryHashes":["2486386679","3128451518"]}