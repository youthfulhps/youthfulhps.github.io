{"version":3,"file":"component---src-pages-index-tsx-416998d70d146948e40f.js","mappings":"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","sources":["webpack://gatsby-starter-bee/./src/_features/Post/List/components/ThumbnailContainer.tsx","webpack://gatsby-starter-bee/./src/_shared/utils/visible.ts","webpack://gatsby-starter-bee/./src/_features/Post/List/components/ThumbnailItem.tsx","webpack://gatsby-starter-bee/./src/_features/Post/List/components/Contents.tsx","webpack://gatsby-starter-bee/./src/_shared/hooks/useIntersectionObserver.ts","webpack://gatsby-starter-bee/./src/pages/index.tsx","webpack://gatsby-starter-bee/./src/_shared/hooks/useRenderedCount.ts","webpack://gatsby-starter-bee/./src/_shared/hooks/useScrollEvent.ts","webpack://gatsby-starter-bee/./src/_shared/utils/event-manager.ts"],"sourcesContent":["import React from 'react';\n\ntype ThumbnailContainerProps = {\n  children: React.ReactNode;\n};\n\nfunction ThumbnailContainer({ children }: ThumbnailContainerProps) {\n  return <div className=\"min-h-[calc(100vh-3.5rem)]\">{children}</div>;\n}\n\nexport default React.memo(ThumbnailContainer);\n","import * as Dom from './dom';\n\nconst ROOT_ID = '#___gatsby';\nexport const TARGET_CLASS = 'observed';\nconst VISIBLE_RECOGNIZE_CLASS = 'visible';\nconst INTERSECTION_OBSERVER_ROOT_MARGIN = '20px';\nconst INTERSECTION_OBSERVER_THRESHOLD = 0.8;\n\nlet observer: IntersectionObserver | null = null;\n\nfunction observeCallback(entries: IntersectionObserverEntry[]): void {\n  entries\n    .filter(({ isIntersecting }) => isIntersecting)\n    .forEach(({ target }) => Dom.addClass(target, VISIBLE_RECOGNIZE_CLASS));\n}\n\nfunction observerTargeting(): void {\n  Dom.getElements(`.${TARGET_CLASS}`).forEach(el => {\n    if (observer) {\n      observer.observe(el);\n    }\n  });\n}\n\nfunction disconnect(): Promise<void> {\n  if (!observer) {\n    throw Error('Not found IntersectionObserver instance');\n  }\n  return Promise.resolve(observer.disconnect());\n}\n\nexport function init(): void {\n  observer = new IntersectionObserver(observeCallback, {\n    root: Dom.getElement(ROOT_ID),\n    rootMargin: INTERSECTION_OBSERVER_ROOT_MARGIN,\n    threshold: INTERSECTION_OBSERVER_THRESHOLD,\n  });\n\n  observerTargeting();\n}\n\nexport function destroy(): void {\n  disconnect();\n  observer = null;\n}\n\nexport function refreshObserver(): Promise<void> {\n  return disconnect().then(observerTargeting);\n}\n\n","import React from 'react';\nimport { Link } from 'gatsby';\nimport { TARGET_CLASS } from '@shared/utils/visible';\nimport { MarkdownRemarkNode } from '@shared/types/gatsby';\n\ntype ThumbnailItemProps = {\n  node: MarkdownRemarkNode;\n};\n\nfunction ThumbnailItem({ node }: ThumbnailItemProps) {\n  return (\n    <Link\n      className={`thumbnail block pb-1 shadow-none transition-[text-shadow,opacity] duration-300 opacity-0 ${TARGET_CLASS} mb-0.5 hover:[text-shadow:var(--text-shadow-light-hover)] dark:hover:[text-shadow:var(--text-shadow-dark-hover)]`}\n      to={node.fields?.slug || ''}\n    >\n      <div key={node.fields?.slug || ''}>\n        <h3 className=\"text-base\">\n          {node.frontmatter?.title || node.fields?.slug}\n        </h3>\n        <div className=\"flex-row items-center\">\n          <p className=\"text-xs opacity-50\">\n            {node.frontmatter?.date}, {node.frontmatter?.description}\n          </p>\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nexport default ThumbnailItem;\n","import React from 'react';\n\nimport ThumbnailContainer from './ThumbnailContainer';\nimport ThumbnailItem from './ThumbnailItem';\nimport { AllMarkdownRemark } from '@shared/types/gatsby';\n\ntype ContentsProps = {\n  posts: AllMarkdownRemark['edges'];\n};\n\nfunction Contents({ posts }: ContentsProps) {\n  return (\n    <ThumbnailContainer>\n      {posts.map(({ node }, index) => (\n        <ThumbnailItem node={node} key={`item_${index}`} />\n      ))}\n    </ThumbnailContainer>\n  );\n}\n\nexport default Contents;\n","import { useEffect } from 'react';\nimport * as IOManager from '@shared/utils/visible';\n\nexport function useIntersectionObserver() {\n  useEffect(() => {\n    IOManager.init();\n    return () => {\n      IOManager.destroy();\n    };\n  }, []);\n\n  useEffect(() => {\n    IOManager.refreshObserver();\n  });\n}\n\n","import { graphql, PageProps } from 'gatsby';\nimport React, { useRef, useEffect, useState } from 'react';\nimport Contents from '@features/Post/List/components/Contents';\nimport Head from '@shared/components/Head';\nimport { HOME_TITLE } from '@shared/constants';\nimport { useIntersectionObserver } from '@shared/hooks/useIntersectionObserver';\nimport { useRenderedCount } from '@shared/hooks/useRenderedCount';\nimport { useScrollEvent } from '@shared/hooks/useScrollEvent';\nimport Layout from '@shared/layouts';\nimport * as Dom from '@shared/utils/dom';\nimport * as EventManager from '@shared/utils/event-manager';\nimport { Site, AllMarkdownRemark } from '@shared/types/gatsby';\n\ntype IndexPageData = {\n  site: Site;\n  allMarkdownRemark: AllMarkdownRemark;\n};\n\ntype IndexPageProps = PageProps<IndexPageData>;\n\nconst BASE_LINE = 80;\n\nfunction getDistance(currentPos: number): number {\n  return Dom.getDocumentHeight() - currentPos;\n}\n\nfunction IndexPage({ data, location }: IndexPageProps) {\n  const { siteMetadata } = data.site;\n  const { countOfInitialPost } = siteMetadata.configs || {};\n  const posts = data.allMarkdownRemark.edges;\n  const bioRef = useRef<HTMLDivElement>(null);\n  const [DEST, setDEST] = useState(316);\n  const [count, countRef, increaseCount] = useRenderedCount();\n\n  useEffect(() => {\n    setDEST(\n      !bioRef.current\n        ? 316\n        : bioRef.current.getBoundingClientRect().bottom +\n            window.pageYOffset +\n            24\n    );\n  }, []);\n\n  useIntersectionObserver();\n  useScrollEvent(() => {\n    const currentPos = window.scrollY + window.innerHeight;\n    const isTriggerPos = () => getDistance(currentPos) < BASE_LINE;\n    const doesNeedMore = () =>\n      posts.length > countRef.current * (countOfInitialPost || 5);\n\n    return EventManager.toFit(increaseCount, {\n      dismissCondition: () => !isTriggerPos(),\n      triggerCondition: () => isTriggerPos() && doesNeedMore(),\n    })();\n  });\n\n  return (\n    <Layout location={location}>\n      <Head title={HOME_TITLE} keywords={siteMetadata.keywords} />\n      <Contents posts={posts} />\n    </Layout>\n  );\n}\n\nexport default IndexPage;\n\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n        configs {\n          countOfInitialPost\n        }\n      }\n    }\n    allMarkdownRemark(\n      sort: { fields: [frontmatter___date], order: DESC }\n      filter: { frontmatter: { category: { ne: null }, draft: { eq: false } } }\n    ) {\n      edges {\n        node {\n          excerpt(pruneLength: 200, truncate: true)\n          fields {\n            slug\n          }\n          frontmatter {\n            date(formatString: \"YYYY.MM.DD\")\n            title\n            description\n            category\n            draft\n            type\n          }\n        }\n      }\n    }\n  }\n`;\n","import { useState, useEffect, useRef } from 'react';\nimport * as Storage from '@shared/utils/storage';\n\nexport function useRenderedCount() {\n  const initialCount = Storage.getCount(1);\n  const [count, setCount] = useState<number>(initialCount);\n  const countRef = useRef<number>(count);\n  const increaseCount = () => setCount(prev => prev + 1);\n\n  useEffect(() => {\n    countRef.current = count;\n    Storage.setCount(count);\n  }, [count]);\n\n  return [count, countRef, increaseCount] as const;\n}\n\n","import { useEffect } from 'react';\n\nexport function useScrollEvent(onScroll: () => void) {\n  useEffect(() => {\n    window.addEventListener('scroll', onScroll, {\n      passive: false,\n    } as AddEventListenerOptions);\n    return () => {\n      window.removeEventListener('scroll', onScroll);\n    };\n  }, [onScroll]);\n}\n","type ToFitOptions = {\n  dismissCondition?: () => boolean;\n  triggerCondition?: () => boolean;\n};\n\nexport function toFit(\n  cb: () => void,\n  {\n    dismissCondition = () => false,\n    triggerCondition = () => true,\n  }: ToFitOptions = {}\n): () => number | undefined {\n  if (!cb) {\n    throw Error('Invalid required arguments');\n  }\n\n  let tick = false;\n\n  return function() {\n    if (tick) {\n      return;\n    }\n\n    tick = true;\n    return requestAnimationFrame(() => {\n      if (dismissCondition()) {\n        tick = false;\n        return;\n      }\n\n      if (triggerCondition()) {\n        tick = false;\n        return cb();\n      }\n    });\n  };\n}\n"],"names":["ThumbnailContainer","_ref","children","React","className","TARGET_CLASS","observer","observeCallback","entries","filter","isIntersecting","forEach","_ref2","target","Dom","observerTargeting","el","observe","disconnect","Error","Promise","resolve","_node$fields","_node$fields2","_node$frontmatter","_node$fields3","_node$frontmatter2","_node$frontmatter3","node","Link","to","fields","slug","key","frontmatter","title","date","description","posts","map","index","ThumbnailItem","useIntersectionObserver","useEffect","IntersectionObserver","root","rootMargin","threshold","then","data","location","siteMetadata","site","countOfInitialPost","configs","allMarkdownRemark","edges","bioRef","useRef","DEST","setDEST","useState","count","countRef","increaseCount","initialCount","Storage","setCount","current","prev","useRenderedCount","onScroll","getBoundingClientRect","bottom","window","pageYOffset","currentPos","scrollY","innerHeight","isTriggerPos","getDistance","cb","_temp","dismissCondition","triggerCondition","tick","requestAnimationFrame","EventManager","length","addEventListener","passive","removeEventListener","Layout","Head","HOME_TITLE","keywords","Contents"],"sourceRoot":""}