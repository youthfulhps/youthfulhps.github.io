---
title: timezone
date: 2023-12-23 19:12:36
category: javascript
thumbnail: { thumbnailSrc }
description: 9시간을 빼라구요? 아니아니 더하라구요?
draft: true
---

타임존(TimeZone)은 로컬 시간이 동일한 지역을 일컫는 말이다. 국가별로 각자의 타임존을 가지고 있고, 면적이 넓은 국가의 경우
지역별로 여러 타임존을 가지고 있는 경우도 있다.

그나저나 타임존도 기준점이 필요하다. 지구가 계속 자전하고 있어 지역별로 낮과 밤이 다른데, 0시라고 결정할 수 있는 기준이 있어야
시간차를 통해 타임존도 결정할 수 있다.

지구 표면상 북극점과 남극점의 최단 거리로 이었을 때 그려지는 세로 선을 자오선(子午線)이라 하는데, 18세기 영국, 프랑스, 독일, 덴마크 등
각 국에서는 자국의 수도를 지나는 자오선을 모든 자오선들의 기준으로 삼았다. 하지만 여기서도 원형 큐의 시작점을 약속하듯이 원형 지구의 경도 0도라 칭하는 자오선 즉,
본초 자오선을 결정해야 했고, 1884년 워싱턴 D.C에서 열린 국제 자오선 회의에서 영국 그리니치 천문대를 지나는 자오선이 본초 자오선으로 채택되었다.

![그리니치 천문대의 본초 자오선](images/time-handling/royal-greenwich-observatory.png)

[이미지 출처](https://m.post.naver.com/viewer/postView.naver?volumeNo=32031087&memberNo=39920442)

이를 토대로 **그리니치 평균시 (Greenwich Mean Time, GMT)**가 표준시로 사용되어 오다, 지구 자전이 조금씩 늦어지는 영향으로 인해
차이가 발생했고, 1972년부터 전 세계 50개 국가 실험실에서 보유한 400개 이상의 세슘 시계를 기반으로 하는
**협정 세계시 (Coordinated Universal Time, UTC)**가 국제 협정시로 사용되기 시작했다.
GMT과 UTC는 소숫점 단위의 미세한 시간차밖에 없어 혼용되곤 하지만, 소프트웨어상에서는 UTC를 사용한다는 표현이 적절하다.

시간의 시작점으로부터 각각의 타임존의 차이는 오프셋(Offset)으로 표현한다. 가령 한국 표준 시간(Korea Standard Time, KST)의 경우 UTC+09:00로
표현하는데, 이는 표준시보다 9시간이 빠르다는 의미이다. UTC 기준 오전 12시라면 한국은 오전 9시가 된다.

아래 세계 시간대의 이미지처럼 영국의 런던에 위치하는 그리니치 천문대를 기준으로 각 지역에서의 타임존을 가지고 있다.

![세계 타임존](./images/time-handling/world-time-zones-map.png)

[이미지 출처](https://ko.wikipedia.org/wiki/%EC%8B%9C%EA%B0%84%EB%8C%80)

### 표준 시간, 일광 절약 시간제

기준을 정하고 지역의 타임존에 대한 오프셋을 부여했지만, 오프셋이 영구적으로 고정되는 것은 아니다. 타임존은 각국에서 법적으로
결정하고 있어 국가의 정치적 혹은 경제적인 이유로 변경되곤 한다. 그 중에서 타임존의 오프셋이 변하는 가장 일반적인 원인은
일광 시간 절약제 (Daylight Saving Time, DST)의 적용이다.

흔히 서머 타임 (Summer Time)라고도 불리는 DST는 표준시를 원래 시간보다 한 시간 앞당긴 시간을 사용하는 것을 말한다. 즉, 0시에
DST를 실시한다면 1시로 시간을 조정해야 한다. 여름에는 일조 시간이 길어 활동을 보다 일찍 시작하여 외부 활동에 더 밝은 상태의 시간을
기대할 수 있도록 만들어진 정책이다.

한국에서도 88 서울 올림픽 중계를 위해 30분을 앞당긴 서머 타임을 적용한 전례가 있는데, 생활 리듬을 깨고 혼란스럽다는 비난 여론으로
인해 올림픽이 끝난 이후로는 시행되지 않았다. 이처럼, 영구적일 것만 같던 타임존의 오프셋은 모종의 이유로 계속 달라질 수 있기 때문에
시스템화를 위해서 역사적인 변경 내역과 더불어 현재 표준시와 DST 적용 내역을 기록하고 공유하고 적용해야 한다.

데이터베이스 기반으로 관리되고 있는 타임존 중 [IANA 타임존 데이터베이스](https://www.iana.org/time-zones)는 리눅스, 유닉스,
java, php 등에서 내부적으로 사용하고 있는 데이터베이스로 타임존에 대한 기록 중 가장 신뢰받고 있다.

UNIX 시간 이후의 데이터를 정확하게 보장하고 있고, 대륙 혹은 대양명과 특이하게 국가명이 아닌 도시명을
조합한 규칙으로 이름을 붙여 관리한다. 예로 서울의 타임존은 Asia/Seoul 이다.

### 시간의 표현

사용자의 타임존에 의존하여 서버로 전달하는 시간의 표현을 담은 데이터는 각각 다른 타임존을 처리해줄 필요가 있다. 가령 서울에서의 오전 9시에
생성된 시간 데이터는 영국에선 오전 0시로 보여져야 한다.

즉 사용자의 다양한 타임존을 고려했을 때, 서버로 전달되는 시간의 표현은 오프셋을 담고 있거나, 해당 클라이언트의 타임존 정보까지 포함되어 있는
값이어야 한다.

일반적으로 이러한 시간의 표현은 UTC를 기준으로 하는 유닉스 시간이나, 오프셋 정보가 포함된 ISO-8601와 같은 형태로 전송한다.

### 유닉스 시간

유닉스 시간은 시각을 나타내는 방식이다. 1970.01.01 00:00:00 UTC 부터의 경과한 시간을 초로 환산하여 정수로 나타낸 것이다.
자바스크립트의 Date 객체의 getTime() 메서드를 통해 구해낼 수 있다.

```js
const current = new Date();
console.log(current.getTime()); // 1704210993948
```

여담으로, 유닉스 시간은 [2038년 문제](https://ko.wikipedia.org/wiki/2038%EB%85%84_%EB%AC%B8%EC%A0%9C)라고 불리는
문제와 점점 가까워지고 있다. 대부분의 32비트 시스템에서 초 시간을 저장하는 데 이용되는 자료 형식은 32비트 정수형인데, 이 형식이 표현할 수 있는
최후의 시각은 2038년 1월 19일 화요일 03:14:07 UTC 이다. 1970년 1월 1일 자정을 기준으로 2147483647초가 흐른 시각인데, 이 시각 이후의
시각은 범위를 초과하여 내부적으로 음수로 표현되어 문제를 야기한다.

부호 없는 32비트나 64비트, 혹은 태양의 수명보다 훨씬 긴 시간을 표현할 수 있는 128비트로 대체하면 해결된다곤 하지만 아직 이 문제의 간단한 해결책은 없다고 한다.

### ISO-8601

[ISO-8601](https://ko.wikipedia.org/wiki/ISO_8601)은 날짜와 시간과 관련된 데이터 교환을 다루는 국제 표준으로 1988년에 처음으로 공개되었다.
시간 작성에 있어 다른 관례를 가진 나라들간의 데이터가 오갈때 발생하는 잡음을 없애고자 만들어진 표준으로 년도-월-일로 구성된 날짜 표기, 연도가 없는 날짜, 연중 일자,
그리고 조합된 UTC 날짜 및 시간 등을 표준화하고 있다.

### 자바스크립트와 타임존

자바스크립트에서는 일반적으로 설치된 OS의 설정된 타임존을 따르게 되어 있고, 명시적으로 타임존을 변경할 수가 없다. 더불어 데이터베이스
표준에 대한 명세도 명확하지 않고 브라우저마다 타임존 연산 또한 다르게 동작할 수 있다.
